---
title: 你需要更优雅的 Dialog/Modal 使用姿势！
date: 2023-03-22 19:21:28
permalink: /pages/1b3356/
categories:
  - JavaScript
tags:
  - 
---

弹窗组件是我们平时开发中使用的最多的组件之一，那么如何更优雅的使用弹窗组件，怎么样封装弹窗组件才更利于业务，怎么样让代码结构变得更清晰，已经是一个势在必行的问题了。

想得多不如做的多，做得多不如看得多，我的思路不代表最优秀的设计，仅是我日常工作中的一些缩影，希望可以帮助到你！

## 常见的弹窗

鉴于Vue的状态驱动的模型，我们的大部分弹窗都是状态驱动的，这是很完美的，也是很舒服的一种使用方式，但是我们很容易就会写出类似于下面的代码：

```html
<template>
  <button @click="openDialog"></button>
  
  <some-dialog v-model:visible="showDialog" @success="handleSuccess" @close="closeDialog" />
</template>

<script setup>
const showDialog = ref(false)

function openDialog() {
    showDialog.value = true
}

function handleSuccess(value) {
  something.value = value
  showDialog.value = false
}

function closeDialog() {
    showDialog.value = false
}
</script>
```

这种写法是没问题的，但是这只是最简单的一种使用方式，基于上面的状态驱动的方式，我们很容易就可以写出很糟糕的代码，看看吧：
```html
<template>
  <button @click="openDialogA"></button>
  <button @click="openDialogB"></button>
  <button @click="openDialogC"></button>
  <button @click="openDialogD"></button>
  <button @click="openDialogE"></button>
  
  <some-dialog-a v-model:visible="showDialogA" @success="handleSuccessA" @close="closeDialogA" />
  <some-dialog-b v-model:visible="showDialogB" @success="handleSuccessB" @close="closeDialogB" />
  <some-dialog-c v-model:visible="showDialogC" @success="handleSuccessC" @close="closeDialogC" />
  <some-dialog-d v-model:visible="showDialogD" @success="handleSuccessD" @close="closeDialogD" />
  <some-dialog-e v-model:visible="showDialogE" @success="handleSuccessE" @close="closeDialogE" />
</template>

<script setup>
const showDialogA = ref(false)

function openDialogA() {...}
function handleSuccessA(value) {...}
function closeDialogA() {...}

const showDialogB = ref(false)

function openDialogB() {...}
function handleSuccessB(value) {...}
function closeDialogB() {...}
  
// ...
</script>
```

相信诸位应该很容易在公司的业务代码中看到如上的代码片段，一个部分的改动有可能牵扯到全局的改动，大家可以想一想，如果，我又需要在弹窗中加一个编辑功能 `isEdit`，我需要修改的内容到底有多少，我们今天的目标是：消除逻辑耦合，组件业务自驱！

## 如何实现业务自驱
